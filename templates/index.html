<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tic Tac Django</title>
  <link rel="stylesheet" type="text/css" href= "/stylesheets/main.css">
</head>
<body>
    <header class="centered"><h1>Tic Tac Django!</h1></header>

    <table id="board" class="centered">
      <tr>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
      </tr>

      <tr>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
      </tr>

      <tr>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
        <td><div class="spot"></div></td>
      </tr>
    </table>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" >

$(document).ready(function() {

    stage = ['','','','','','','','','',];
    playerChar = 'X';
    aiChar = 'O';
    playersTurn = true;

    //adds an onClick function onto each table cell's div
    $(".spot").each(function(i,o){
        $(o).attr("id",i)
        $(o).click(function(){
            if($(this).html()=='' && playersTurn){
                $(this).html(playerChar);
                playersTurn = false;
                stage[i] = playerChar;
                takePcTurn();
            }
        });
    });
});

function takePcTurn(){
    $.ajax({
        type: 'GET',
        url: '/ai',
        data: { "stage":JSON.stringify(stage),
                "playerChar":playerChar,
                "aiChar":aiChar,
              },
        success: function(data){
            console.log(data);
            stage[data["aiMove"]] = aiChar;
            $('#'+data["aiMove"]).html(aiChar);
            playersTurn = true;
        },
        dataType: 'json'
    });
}


    </script>
</body>
</html>
